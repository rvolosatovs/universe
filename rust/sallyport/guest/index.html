<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Guest entrypoint into the sallyport."><meta name="keywords" content="rust, rustlang, rust-lang, guest"><title>sallyport::guest - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" type="text/css" href="../../normalize.css"><link rel="stylesheet" type="text/css" href="../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../ayu.css" disabled><link rel="stylesheet" type="text/css" href="../../dark.css" disabled><link rel="stylesheet" type="text/css" href="../../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../../storage.js"></script><script src="../../crates.js"></script><script defer src="../../main.js"></script>
    <noscript><link rel="stylesheet" href="../../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../../favicon.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a class="sidebar-logo" href="../../sallyport/index.html"><div class="logo-container"><img class="rust-logo" src="../../rust-logo.png" alt="logo"></div>
        </a><h2 class="location">Module guest</h2><div class="sidebar-elems"><div class="block items"><ul><li><a href="#modules">Modules</a></li><li><a href="#structs">Structs</a></li><li><a href="#traits">Traits</a></li></ul></div><div id="sidebar-vars" data-name="guest" data-ty="mod" data-relpath="./"></div><script defer src="./sidebar-items.js"></script></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../../sallyport/index.html"><img class="rust-logo" src="../../rust-logo.png" alt="logo"></a><nav class="sub"><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="18" height="18" alt="Pick another theme!" src="../../brush.svg"></button><div id="theme-choices" role="menu"></div></div><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../../settings.html" title="settings"><img width="18" height="18" alt="Change settings" src="../../wheel.svg"></a></div></form></nav></div><section id="main-content" class="content"><h1 class="fqn"><span class="in-band">Module <a href="../index.html">sallyport</a>::<wbr><a class="mod" href="#">guest</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../../src/sallyport/guest/mod.rs.html#3-64" title="goto source code">[src]</a></span></h1><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Guest entrypoint into the sallyport.</p>
<p>The main entrypoint into this module is a long-lived <a href="struct.Handler.html" title="Handler"><code>Handler</code></a>, which allocates the requests
within the untrusted sallyport block, passes control to the host for execution of the block via
<a href="trait.Platform.html#tymethod.sally">platform-specific <code>sally</code></a> and reads the replies once it gets the control
back after verifying the integrity of the block.</p>
<p>In case the <a href="struct.Handler.html" title="Handler"><code>Handler</code></a> detects that integrity of the request block is not maintained, it
attempts to <a href="struct.Handler.html#method.exit"><code>exit</code></a> immediately and does so in an infinite loop.</p>
<p><a href="struct.Handler.html" title="Handler"><code>Handler</code></a> provides:</p>
<ul>
<li>
<p>API for execution of an arbitrary <a href="trait.Call.html" title="Call"><code>Call</code></a>:</p>
<ul>
<li><a href="struct.Handler.html#method.execute"><code>execute</code></a></li>
</ul>
</li>
<li>
<p><a href="../../libc/index.html" title="libc"><code>libc</code></a>-like API for syscall execution using safe Rust abstractions where possible, for example:</p>
<ul>
<li><a href="struct.Handler.html#method.syscall"><code>syscall</code></a> corresponding to <a href="../../libc/unix/linux_like/linux/fn.syscall.html" title="libc::syscall"><code>libc::syscall</code></a>.</li>
<li><a href="struct.Handler.html#method.read"><code>read</code></a> corresponding to <a href="../../libc/unix/fn.read.html" title="libc::read"><code>libc::read</code></a>.</li>
<li><a href="struct.Handler.html#method.exit"><code>exit</code></a> corresponding to <a href="../../libc/unix/fn.exit.html" title="libc::exit"><code>libc::exit</code></a>.</li>
</ul>
</li>
</ul>
<h2 id="call-lifetime-phases" class="section-header"><a href="#call-lifetime-phases">Call lifetime phases</a></h2>
<p>The crate identifies 3 distinct phases of an arbitrary call lifetime:</p>
<h3 id="stage" class="section-header"><a href="#stage">Stage</a></h3>
<p>In this phase <a href="alloc/struct.InRef.html">input references</a>, <a href="alloc/struct.OutRef.html">output references</a> and <a href="alloc/struct.InOutRef.html">inout references</a> are sequentially allocated within the untrusted sallyport block.</p>
<p>Once this phase is finished, no more allocations can be made within the untrusted sallyport block.</p>
<h3 id="commit" class="section-header"><a href="#commit">Commit</a></h3>
<p>In this phase data is written to <a href="alloc/struct.InRef.html">input references</a> and <a href="alloc/struct.InOutRef.html">inout references</a> allocated in the stage phase.
This may happen concurrently for <code>N</code> staged requests.</p>
<p>Once this phase is finished, the untrusted sallyport block is ready to be passed to the host for execution
via <a href="trait.Platform.html#tymethod.sally">platform-specific <code>sally</code></a>.</p>
<p>Entities that can be committed implement the <a href="alloc/trait.Commit.html"><code>Commit</code></a> trait.</p>
<h3 id="collect" class="section-header"><a href="#collect">Collect</a></h3>
<p>In this phase data is read from <a href="alloc/struct.OutRef.html">output references</a> and <a href="alloc/struct.InOutRef.html">inout references</a> allocated in the stage phase.
This may happen concurrently for <code>N</code> staged requests.</p>
<p>This phase starts after the control returns to the guest.
Once this phase is finished, the data within block is considered to be invalid, it may be left unchanged,
but it may also be overwritten or dropped depending on request implementation</p>
<p>Entities that can be collected implement the <a href="alloc/trait.Collect.html"><code>Collect</code></a> trait.</p>
</div></details><h2 id="modules" class="small-section-header"><a href="#modules">Modules</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="mod" href="alloc/index.html" title="sallyport::guest::alloc mod">alloc</a></div><div class="item-right docblock-short"><p>Allocation-specific functionality.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="syscall/index.html" title="sallyport::guest::syscall mod">syscall</a></div><div class="item-right docblock-short"><p>Syscall-specific functionality.</p>
</div></div></div><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Handler.html" title="sallyport::guest::Handler struct">Handler</a></div><div class="item-right docblock-short"><p>Guest request handler.</p>
</div></div></div><h2 id="traits" class="small-section-header"><a href="#traits">Traits</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.Call.html" title="sallyport::guest::Call trait">Call</a></div><div class="item-right docblock-short"><p>An <a href="trait.Execute.html#tymethod.execute">executable</a> call.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.Execute.html" title="sallyport::guest::Execute trait">Execute</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.Platform.html" title="sallyport::guest::Platform trait">Platform</a></div><div class="item-right docblock-short"><p>Platform-specific functionality.</p>
</div></div></div></section><section id="search" class="content hidden"></section></div></main><div id="rustdoc-vars" data-root-path="../../" data-current-crate="sallyport" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.59.0-nightly (34926f0a1 2021-12-22)" ></div>
</body></html>